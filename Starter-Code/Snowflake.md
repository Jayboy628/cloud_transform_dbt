#  Implementing dedicated virtual warehouse

<table>
<tr> 
    <th><h4>CREATE DATA WAREHOUSE (SQL)</h4></th>
</tr>
<tr>
<td>  
<pre lang="js">
`USE ROLE ACCOUNTADMIN;`
CREATE WAREHOUSE TRANSFORM_WH 
    WITH WAREHOUSE_SIZE = 'XSMALL'
    WAREHOUSE_TYPE = 'STANDARD' 
    AUTO_SUSPEND = 300 
    AUTO_RESUME = TRUE 
    MIN_CLUSTER_COUNT = 1 
    MAX_CLUSTER_COUNT = 1 
    SCALING_POLICY = 'STANDARD'
    COMMENT = 'This is Data warehouse is for world wide basicle store';
</pre>
</td>
</tr>
</table>

#### CREATE ROLE for Data Engineer

`CREATE ROLE TRANSFORM_ROLE;`

#### GRANT PRIV SYSADMIN

`GRANT MODIFY ON WAREHOUSE TRANSFORM_WH TO ROLE ACCOUNTADMIN`
<table>
<tr> 
    <th><h4>CREATE DATA ENGINEER USER (SQL)</h4></th>
</tr>
<tr>
<td>  
<pre lang="js">

CREATE USER TRANSFORM_USER
PASSWORD = 'Rassman123' 
LOGIN_NAME = 'TRANSFORM_USER' 
DEFAULT_ROLE='TRANSFORM_ROLE' 
DEFAULT_WAREHOUSE = 'TRANSFORM_WH'  
MUST_CHANGE_PASSWORD = FALSE;

GRANT ROLE TRANSFORM_ROLE TO USER TRANSFORM_USER;
</pre>
</td>
</tr>
</table>



#### CREATE DATABASES

`CREATE DATABASE RAW;`
`CREATE DATABASE ANALYTICS_DEV;`
`CREATE DATABASE ANALYTICS;`

<details>
    <summary><h4>MODFIY DATABASE PRIV</h4> </summary>

* `GRANT MODIFY ON DATABASE` RAW TO ROLE TRANSFORM_ROLE;
* `GRANT MODIFY ON DATABASE` ANALYTICS_DEV TO ROLE TRANSFORM_ROLE;
* `GRANT MODIFY ON DATABASE` ANALYTICS TO ROLE TRANSFORM_ROLE;
***
* `GRANT USAGE ON DATABASE` RAW TO ROLE TRANSFORM_ROLE;
* `GRANT USAGE ON DATABASE` ANALYTICS_DEV TO ROLE TRANSFORM_ROLE;
* `GRANT USAGE ON DATABASE` ANALYTICS TO ROLE TRANSFORM_ROLE;

</details>

<details>
    <summary><h4>GRANT PRIVALEGE ON RAW DATABASE FOR SCHEMA,TABLES AND VIEWS</h4> </summary>

* `GRANT CREATE SCHEMA ON DATABASE` RAW TO ROLE TRANSFORM_ROLE;
* `GRANT MODIFY ON DATABASE` RAW TO ROLE TRANSFORM_ROLE;
* `GRANT MODIFY ON ALL SCHEMAS` IN DATABASE RAW TO ROLE TRANSFORM_ROLE;
***
* `GRANT USAGE ON DATABASE` RAW TO ROLE TRANSFORM_ROLE;
* `GRANT USAGE ON ALL SCHEMAS IN DATABASE` RAW TO ROLE TRANSFORM_ROLE;
***
* GRANT SELECT ON ALL TABLES IN DATABASE RAW TO ROLE TRANSFORM_ROLE;
* GRANT SELECT ON ALL VIEWS IN DATABASE RAW TO ROLE TRANSFORM_ROLE;


// GRANT PRIVALEGE ON ANALYTICS_DEV DATABASE FOR SCHEMA,TABLES AND VIEWS

GRANT CREATE SCHEMA ON DATABASE ANALYTICS_DEV TO ROLE TRANSFORM_ROLE;

GRANT MODIFY ON DATABASE ANALYTICS_DEV TO ROLE TRANSFORM_ROLE;
GRANT MODIFY ON ALL SCHEMAS IN DATABASE ANALYTICS_DEV TO ROLE TRANSFORM_ROLE;

GRANT USAGE ON DATABASE ANALYTICS_DEV TO ROLE TRANSFORM_ROLE;
GRANT USAGE ON ALL SCHEMAS IN DATABASE ANALYTICS_DEV TO ROLE TRANSFORM_ROLE;

GRANT SELECT ON ALL TABLES IN DATABASE ANALYTICS_DEV TO ROLE TRANSFORM_ROLE;
GRANT SELECT ON ALL VIEWS IN DATABASE ANALYTICS_DEV TO ROLE TRANSFORM_ROLE;



// GRANT PRIVALEGE ON ANALYTICS DATABASE FOR SCHEMA,TABLES AND VIEWS

GRANT CREATE SCHEMA ON DATABASE ANALYTICS TO ROLE TRANSFORM_ROLE;

GRANT MODIFY ON DATABASE ANALYTICS TO ROLE TRANSFORM_ROLE;
GRANT MODIFY ON ALL SCHEMAS IN DATABASE ANALYTICS TO ROLE TRANSFORM_ROLE;

GRANT USAGE ON DATABASE ANALYTICS TO ROLE TRANSFORM_ROLE;
GRANT USAGE ON ALL SCHEMAS IN DATABASE ANALYTICS TO ROLE TRANSFORM_ROLE;


GRANT SELECT ON ALL TABLES IN DATABASE ANALYTICS TO ROLE TRANSFORM_ROLE;
GRANT SELECT ON ALL VIEWS IN DATABASE ANALYTICS TO ROLE TRANSFORM_ROLE;


-- CREATE SCHEMA

USE ROLE TRANSFORM_ROLE;


CREATE SCHEMA RAW.HumanResources;
CREATE SCHEMA RAW.Person;
CREATE SCHEMA RAW.Production;
CREATE SCHEMA RAW.Sales;


GRANT SELECT ON ALL TABLES IN SCHEMA HumanResources to role TRANSFORM_ROLE;
GRANT SELECT ON ALL TABLES IN SCHEMA Person to role TRANSFORM_ROLE;
GRANT SELECT ON ALL TABLES IN SCHEMA Production to role TRANSFORM_ROLE;
GRANT SELECT ON ALL TABLES IN SCHEMA Sales to role TRANSFORM_ROLE;

GRANT SELECT ON ALL TABLES IN SCHEMA HumanResources to role TRANSFORM_ROLE;
GRANT SELECT ON ALL TABLES IN SCHEMA Person to role TRANSFORM_ROLE;
GRANT SELECT ON ALL TABLES IN SCHEMA Production to role TRANSFORM_ROLE;
GRANT SELECT ON ALL TABLES IN SCHEMA Sales to role TRANSFORM_ROLE;

GRANT SELECT ON ALL TABLES IN SCHEMA HumanResources to role TRANSFORM_ROLE;
GRANT SELECT ON ALL TABLES IN SCHEMA Person to role TRANSFORM_ROLE;
GRANT SELECT ON ALL TABLES IN SCHEMA Production to role TRANSFORM_ROLE;
GRANT SELECT ON ALL TABLES IN SCHEMA Sales to role TRANSFORM_ROLE;

USE ROLE ACCOUNTADMIN;

GRANT SELECT ON FUTURE TABLES IN SCHEMA HumanResources to role TRANSFORM_ROLE;
GRANT SELECT ON FUTURE TABLES IN SCHEMA Person to role TRANSFORM_ROLE;
GRANT SELECT ON FUTURE TABLES IN SCHEMA Production to role TRANSFORM_ROLE;
GRANT SELECT ON FUTURE TABLES IN SCHEMA Sales to role TRANSFORM_ROLE;

GRANT MODIFY ON FUTURE TABLES IN SCHEMA HumanResources to role TRANSFORM_ROLE;
GRANT MODIFY ON FUTURE TABLES IN SCHEMA Person to role TRANSFORM_ROLE;
GRANT MODIFY ON FUTURE TABLES IN SCHEMA Production to role TRANSFORM_ROLE;
GRANT MODIFY ON FUTURE TABLES IN SCHEMA Sales to role TRANSFORM_ROLE;

GRANT USAGE ON FUTURE TABLES IN SCHEMA HumanResources to role TRANSFORM_ROLE;
GRANT USAGE ON FUTURE TABLES IN SCHEMA Person to role TRANSFORM_ROLE;
GRANT USAGE ON FUTURE TABLES IN SCHEMA Production to role TRANSFORM_ROLE;
GRANT USAGE ON FUTURE TABLES IN SCHEMA Sales to role TRANSFORM_ROLE;


GRANT SELECT ON FUTURE TABLES IN DATABASE ANALYTICS TO ROLE TRANSFORM_ROLE;
GRANT SELECT ON FUTURE VIEWS IN DATABASE ANALYTICS TO ROLE TRANSFORM_ROLE;

GRANT SELECT ON FUTURE TABLES IN DATABASE ANALYTICS_DEV TO ROLE TRANSFORM_ROLE;
GRANT SELECT ON FUTURE VIEWS IN DATABASE ANALYTICS_DEV TO ROLE TRANSFORM_ROLE;

GRANT SELECT ON FUTURE TABLES IN DATABASE RAW TO ROLE TRANSFORM_ROLE;
GRANT SELECT ON FUTURE VIEWS IN DATABASE RAW TO ROLE TRANSFORM_ROLE;





