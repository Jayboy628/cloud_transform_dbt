begin;
    
        
            
            
        
    

    

    merge into ANALYTICS_DEV.warehouse.dim_products as DBT_INTERNAL_DEST
        using ANALYTICS_DEV.warehouse.dim_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.PRODUCT_KEY = DBT_INTERNAL_DEST.PRODUCT_KEY
            

    
    when matched then update set
        "PRODUCT_KEY" = DBT_INTERNAL_SOURCE."PRODUCT_KEY","PRODUCTID" = DBT_INTERNAL_SOURCE."PRODUCTID","PRODUCTMODELID" = DBT_INTERNAL_SOURCE."PRODUCTMODELID","PRODUCTSUBCATEGORYID" = DBT_INTERNAL_SOURCE."PRODUCTSUBCATEGORYID","NAME" = DBT_INTERNAL_SOURCE."NAME","STANDARDCOST" = DBT_INTERNAL_SOURCE."STANDARDCOST","LISTPRICE" = DBT_INTERNAL_SOURCE."LISTPRICE","MODIFIEDDATE" = DBT_INTERNAL_SOURCE."MODIFIEDDATE","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT","DBT_VALID_FROM" = DBT_INTERNAL_SOURCE."DBT_VALID_FROM","DBT_VALID_TO" = DBT_INTERNAL_SOURCE."DBT_VALID_TO"
    

    when not matched then insert
        ("PRODUCT_KEY", "PRODUCTID", "PRODUCTMODELID", "PRODUCTSUBCATEGORYID", "NAME", "STANDARDCOST", "LISTPRICE", "MODIFIEDDATE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO")
    values
        ("PRODUCT_KEY", "PRODUCTID", "PRODUCTMODELID", "PRODUCTSUBCATEGORYID", "NAME", "STANDARDCOST", "LISTPRICE", "MODIFIEDDATE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO")

;
    commit;